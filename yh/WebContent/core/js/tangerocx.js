var TANGER_OCX_bDocOpen=false;var TANGER_OCX_strOp;var TANGER_OCX_filename;var TANGER_OCX_attachName;var TANGER_OCX_attachURL;var TANGER_OCX_actionURL;var TANGER_OCX_OBJ;var TANGER_OCX_user;function AddPictureFromLocal(){if(TANGER_OCX_bDocOpen){TANGER_OCX_OBJ.AddPicFromLocal("",true,true,100,100)}}function AddPictureFromURL(URL){if(TANGER_OCX_bDocOpen){TANGER_OCX_OBJ.AddPicFromURL(URL,true,150,150)}}function AddSignFromLocal(key){if(TANGER_OCX_bDocOpen){TANGER_OCX_OBJ.AddSignFromLocal(TANGER_OCX_user,"",true,0,0,key)}}function AddSignFromURL(URL,key){if(TANGER_OCX_bDocOpen){TANGER_OCX_OBJ.AddSignFromURL(TANGER_OCX_user,URL,50,50,key)}}function DoHandSign(key){if(TANGER_OCX_bDocOpen){TANGER_OCX_OBJ.DoHandSign(TANGER_OCX_user,0,255,2,100,50,null,key)}}function DoHandSign2(key){if(TANGER_OCX_bDocOpen){TANGER_OCX_OBJ.DoHandSign2(TANGER_OCX_user,key,0,0,0,100)}}function DoHandDraw(){if(TANGER_OCX_bDocOpen){TANGER_OCX_OBJ.DoHandDraw(0,16711680,3,200,50)}}function DoHandDraw2(){if(TANGER_OCX_bDocOpen){TANGER_OCX_OBJ.DoHandDraw2()}}function DoCheckSign(key){if(TANGER_OCX_bDocOpen){var ret=TANGER_OCX_OBJ.DoCheckSign(false,key)}}function TANGER_OCX_AddDocHeader(strHeader){var i,cNum=15;var lineStr="";try{for(i=0;i<cNum;i++){lineStr+="_"}with(TANGER_OCX_OBJ.ActiveDocument.Application){Selection.HomeKey(6,0);Selection.TypeText(strHeader);Selection.TypeParagraph();Selection.TypeText(lineStr);Selection.TypeText("★");Selection.TypeText(lineStr);Selection.TypeParagraph();Selection.HomeKey(6,1);Selection.ParagraphFormat.Alignment=1;with(Selection.Font){NameFarEast="宋体";Name="宋体";Size=22;Bold=true;Italic=false;Underline=0;UnderlineColor=0;StrikeThrough=false;DoubleStrikeThrough=false;Outline=false;Emboss=false;Shadow=false;Hidden=false;SmallCaps=false;AllCaps=false;Color=255;Engrave=false;Superscript=false;Subscript=false;Spacing=0;Scaling=100;Position=0;Kerning=0;Animation=0;DisableCharacterSpaceGrid=false;EmphasisMark=0}Selection.MoveDown(5,3,0)}}catch(err){}finally{}}function TANGER_OCX_doFormOnSubmit(){var form=document.forms[0];if(form.onsubmit){var retVal=form.onsubmit();if(typeof retVal=="boolean"&&retVal==false){return false}}return true}function TANGER_OCX_genDominoPara(paraObj){var fmElements=document.forms[0].elements;var i,j,elObj,optionItem;for(i=0;i<fmElements.length;i++){elObj=fmElements[i];switch(elObj.type){case"file":paraObj.FFN=elObj.name;break;case"reset":break;case"radio":case"checkbox":if(elObj.checked){paraObj.PARA+=(elObj.name+"="+escape(elObj.value)+"&")}break;case"select-multiple":for(j=0;j<elObj.options.length;j++){optionItem=elObj.options[j];if(optionItem.selected){paraObj.PARA+=(elObj.name+"="+escape(optionItem.value)+"&")}}break;default:if(elObj.name){paraObj.PARA+=(elObj.name+"="+escape(elObj.value)+"&")}break}}}function TANGER_OCX_SetReadOnly(boolvalue){var appName,i;try{if(boolvalue){TANGER_OCX_OBJ.IsShowToolMenu=false}with(TANGER_OCX_OBJ.ActiveDocument){appName=new String(Application.Name);if((appName.toUpperCase()).indexOf("WORD")>-1){if(ProtectionType!=-1&&!boolvalue){Unprotect()}if(ProtectionType==-1&&boolvalue){Protect(2,true,"")}}else{if((appName.toUpperCase()).indexOf("EXCEL")>-1){for(i=1;i<=Application.Sheets.Count;i++){if(boolvalue){Application.Sheets(i).Protect("",true,true,true)}else{Application.Sheets(i).Unprotect("")}}if(boolvalue){Application.ActiveWorkbook.Protect("",true)}else{Application.ActiveWorkbook.Unprotect("")}}else{}}}}catch(err){}finally{}}function TANGER_OCX_SetNoCopy(boolvalue){TANGER_OCX_OBJ.IsNoCopy=boolvalue}function TANGER_OCX_EnableFileNewMenu(boolvalue){TANGER_OCX_OBJ.EnableFileCommand(0)=boolvalue}function TANGER_OCX_EnableFileOpenMenu(boolvalue){TANGER_OCX_OBJ.EnableFileCommand(1)=boolvalue}function TANGER_OCX_EnableFileSaveMenu(boolvalue){TANGER_OCX_OBJ.EnableFileCommand(3)=boolvalue}function TANGER_OCX_EnableFileSaveAsMenu(boolvalue){TANGER_OCX_OBJ.EnableFileCommand(4)=boolvalue}function TANGER_OCX_EnableFilePrintMenu(boolvalue){TANGER_OCX_OBJ.EnableFileCommand(5)=boolvalue}function TANGER_OCX_EnableFilePrintPreviewMenu(boolvalue){TANGER_OCX_OBJ.EnableFileCommand(6)=boolvalue}function TANGER_OCX_EnableReviewBar(boolvalue){TANGER_OCX_OBJ.ActiveDocument.CommandBars("Reviewing").Enabled=boolvalue;TANGER_OCX_OBJ.ActiveDocument.CommandBars("Track Changes").Enabled=boolvalue;TANGER_OCX_OBJ.IsShowToolMenu=boolvalue}function TANGER_OCX_SetReviewMode(boolvalue){TANGER_OCX_OBJ.ActiveDocument.TrackRevisions=boolvalue}function TANGER_OCX_SetMarkModify(boolvalue){TANGER_OCX_SetReviewMode(boolvalue)}function TANGER_OCX_ShowRevisions(boolvalue){TANGER_OCX_OBJ.ActiveDocument.ShowRevisions=boolvalue}function TANGER_OCX_PrintRevisions(boolvalue){TANGER_OCX_OBJ.ActiveDocument.PrintRevisions=boolvalue}function TANGER_OCX_SetDocUser(cuser){with(TANGER_OCX_OBJ.ActiveDocument.Application){UserName=cuser}}function TANGER_OCX_ChgLayout(){try{TANGER_OCX_OBJ.showdialog(5)}catch(err){alert("错误："+err.number+":"+err.description)}finally{}}function TANGER_OCX_PrintDoc(){try{TANGER_OCX_OBJ.printout(true)}catch(err){alert("错误："+err.number+":"+err.description)}finally{}}function TANGER_OCX_SetInfo(){var info;TANGER_OCX_OBJ=document.all.item("TANGER_OCX");TANGER_OCX_EnableFileNewMenu(false);TANGER_OCX_EnableFileOpenMenu(false);TANGER_OCX_EnableFileSaveMenu(false);TANGER_OCX_EnableFileSaveAsMenu(false);try{TANGER_OCX_actionURL=document.forms[0].action;TANGER_OCX_strOp=document.all.item("TANGER_OCX_op").innerHTML;TANGER_OCX_filename=document.all.item("TANGER_OCX_filename").innerHTML;TANGER_OCX_attachName=document.all.item("TANGER_OCX_attachName").innerHTML;TANGER_OCX_attachURL=document.all.item("TANGER_OCX_attachURL").innerHTML;TANGER_OCX_user=document.all.item("TANGER_OCX_user").innerHTML;re=/&amp;/g;TANGER_OCX_attachURL=TANGER_OCX_attachURL.replace(re,"&");if(TANGER_OCX_OBJ.IsHiddenOpenURL){TANGER_OCX_attachURL=TANGER_OCX_HiddenURL(TANGER_OCX_attachURL)}switch(TANGER_OCX_strOp){case"1":info="新Word文档";TANGER_OCX_OBJ.CreateNew("Word.Document");break;case"2":info="新Excel工作表";TANGER_OCX_OBJ.CreateNew("Excel.Sheet");break;case"3":info="新PowserPoint幻灯片";TANGER_OCX_OBJ.CreateNew("PowerPoint.Show");break;case"4":info="编辑文档";if(TANGER_OCX_attachURL){encodeURI(TANGER_OCX_attachURL);TANGER_OCX_OBJ.BeginOpenFromURL(encodeURI(TANGER_OCX_attachURL))}else{TANGER_OCX_OBJ.CreateNew("Word.Document")}break;case"5":info="阅读文档";if(TANGER_OCX_attachURL){TANGER_OCX_OBJ.OpenFromURL(TANGER_OCX_attachURL,true)}break;default:info="未知操作"}if(TANGER_OCX_filename.indexOf(".ppt")<0&&TANGER_OCX_filename.indexOf(".PPT")<0){TANGER_OCX_SetDocUser(TANGER_OCX_user)}}catch(err){msg="不能使用微软Office软件打开文档！\n\n是否尝试使用金山WPS文字处理软件打开文档？"}finally{}}function TANGER_OCX_OnDocumentClosed(){TANGER_OCX_bDocOpen=false}function TANGER_OCX_SaveDoc(op_flag){var retStr=new String;var newwin,newdoc;var paraObj=new Object();paraObj.PARA="";paraObj.FFN="";try{if(!TANGER_OCX_doFormOnSubmit()){return}TANGER_OCX_genDominoPara(paraObj);alert(TANGER_OCX_actionURL);alert(TANGER_OCX_filename);if(!paraObj.FFN){alert("参数错误：控件的第二个参数没有指定。");return}if(!TANGER_OCX_bDocOpen){alert("没有打开的文档。");return}switch(TANGER_OCX_strOp){case"1":case"2":case"3":case"4":retStr=TANGER_OCX_OBJ.SaveToURL(TANGER_OCX_actionURL,paraObj.FFN,paraObj.PARA,TANGER_OCX_filename);window.alert(retStr);if(op_flag==1){close_op_flag=1;window.close()}break;case"5":alert("文档处于阅读状态，您不能保存到服务器。");default:break}}catch(err){alert("不能保存到URL："+err.number+":"+err.description)}finally{}}function TANGER_OCX_OnDocumentOpened(str,obj){var s,s2;try{TANGER_OCX_bDocOpen=true;if(0==str.length){str=TANGER_OCX_filename}TANGER_OCX_OBJ.Caption=TANGER_OCX_filename;s="未知应用程序";if(obj){switch(TANGER_OCX_strOp){case"1":case"2":case"3":case"4":TANGER_OCX_SetReadOnly(false);break;case"5":TANGER_OCX_SetReadOnly(true);break;default:break}s=obj.Application.Name}}catch(err){window.status="OnDocumentOpened事件的Script产生错误。"+err.number+":"+err.description}finally{}};