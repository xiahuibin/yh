var CODE_SPLIT="-";var TREE_CONST=new TreeConst;if(!Array.prototype.contains){Array.prototype.contains=function(elem){if(!elem){return false}for(var i=0;i<this.length;i++){if(this[i]==elem){return true}}return false}}if(!Array.prototype.add){Array.prototype.add=function(data,index){if(index<0){return}if(index==null||index>=this.length){index=this.length}for(var i=this.length;i>index;i--){this[i]=this[i-1]}this[index]=data}}if(!Array.prototype.addAll){Array.prototype.addAll=function(dataList,index){if(index<0){return}var dataCnt=dataList.size();if(!dataCnt||dataCnt<1){return}if(index==null||index>=this.length){index=this.length}for(var i=this.length+dataCnt-1;i>index+dataCnt-1;i--){this[i]=this[i-dataCnt]}for(var i=index;i<index+dataCnt;i++){this[i]=dataList.get(i-index)}}}if(!Array.prototype.setAt){Array.prototype.setAt=function(data,index){if(index<0){return}if(index==null||index>=this.length){index=this.length}this[index]=data}}if(!Array.prototype.size){Array.prototype.size=function(){return this.length}}if(!Array.prototype.get){Array.prototype.get=function(index){if(index==null||index<0||index>=this.size()){return null}return this[index]}}if(!Array.prototype.getLast){Array.prototype.getLast=function(){return this.get(this.size()-1)}}if(!Array.prototype.remove){Array.prototype.remove=function(index){if(index==null){index=this.length-1}if(index<0){return}if(index>=this.length){return}for(var i=index;i<this.length-1;i++){this[i]=this[i+1]}this[this.length-1]=null;this.length--}}if(!Array.prototype.clear){Array.prototype.clear=function(){for(var i=0;i<this.size();i++){this[i]=null}this.length=0}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(data){for(var i=0;i<this.size();i++){if(this[i]==data){return i}}return -1}}if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(data){for(var i=this.size()-1;i>=0;i--){if(this[i]==data){return i}}return -1}}if(!Array.prototype.indexOfGreat){Array.prototype.indexOfGreat=function(data){for(var i=0;i<this.size();i++){if(this[i]>data){return i}}return -1}}if(!Array.prototype.clone){Array.prototype.clone=function(other){this.clear();for(var i=0;i<other.size();i++){this.add(other.get(i))}}}if(!Array.prototype.sortObj){Array.prototype.sortObj=function(key,isDesc,type){for(var i=0,n=this.size();i<n;i++){var currIndex=i;for(var j=i+1;j<n;j++){if(isDesc){if(compare(this[j],this[currIndex],key,type)>0){currIndex=j}}else{if(compare(this[j],this[currIndex],key,type)<0){currIndex=j}}}if(currIndex!=i){var tmpObj=this[i];this[i]=this[currIndex];this[currIndex]=tmpObj}}}}function ArrayHashMap(){this.keyList=new Array();this.valueList=new Array();this.put=function(key,obj){var keyIndex=this.keyList.indexOf(key);if(keyIndex<0){this.keyList.add(key);this.valueList.add(obj)}else{this.keyList.setAt(key,keyIndex);this.valueList.setAt(obj,keyIndex)}};this.get=function(key){var keyIndex=this.keyList.indexOf(key);if(keyIndex<0){return null}return this.valueList.get(keyIndex)};this.remove=function(key){var keyIndex=this.keyList.indexOf(key);if(keyIndex<0){return}this.keyList.remove(keyIndex);this.valueList.remove(keyIndex)};this.removeLast=function(){var index=this.size()-1;this.valueList.remove(index);this.keyList.remove(index)};this.clear=function(){this.keyList.clear();this.valueList.clear()};this.getKeyCnt=function(){return this.keyList.size()};this.getKey=function(keyIndex){return this.keyList.get(keyIndex)};this.getValueCnt=function(){return this.valueList.size()};this.getValue=function(valueIndex){return this.valueList.get(valueIndex)};this.containsKey=function(key){return this.keyList.contains(key)};this.containsValue=function(objValue){return this.valueList.contains(objValue)};this.keyIndexOf=function(key){return this.keyList.indexOf(key)};this.keyIndexOfGreat=function(key){return this.keyList.indexOfGreat(key)};this.size=function(){return this.keyList.size()}}function CodeRecord(code,desc){this.code=code;this.desc=desc;this.getCode=function(){if(this.code===""){return""}return this.code?this.code:0};this.setCode=function(code){this.code=code};this.getDesc=function(){return this.desc?this.desc:""};this.setDesc=function(desc){this.desc=desc}}function TreeConst(){this.ROOT_NODE=0;this.BRANCH_NODE=1;this.LEAF_NODE=2}function TreeNode(nodeNo,dataArray){this.nodeNo=nodeNo;this.dataArray=dataArray;this.isOpenState=false;this.isFolderState=true;this.isSelected=false;this.styleClass=null;this.index=-1;this.childList=new Array();this.parentNode=null;this.getNodeNo=function(){return this.nodeNo?this.nodeNo:""};this.getParentNo=function(){var parentNo=null;var lastIndex=nodeNo.lastIndexOf(CODE_SPLIT);if(lastIndex>0){parentNo=nodeNo.substring(0,lastIndex)}return parentNo};this.getRootNo=function(){var rootNo=this.nodeNo;var index=nodeNo.indexOf(CODE_SPLIT);if(index>0){rootNo=nodeNo.substring(0,index)}return rootNo};this.addData=function(data,index){this.dataArray.add(data,index)};this.setAt=function(data,index){this.dataArray.setAt(data,index)};this.getData=function(index){return this.dataArray.get(index)};this.getLength=function(){return this.dataArray.size()};this.isChild=function(node){if(!node){return false}if(this.isDesndntNode(node.getNodeNo())&&(this.getLevelCnt()-node.getLevelCnt()==1)){return true}return false};this.isDesndntNode=function(nodeNo){if(!nodeNo){return false}var thisNo=this.getNodeNo();if(thisNo.length>nodeNo.length&&thisNo.indexOf(nodeNo)==0){return true}return false};this.getLevelCnt=function(){var nodeNo=this.getNodeNo();if(!nodeNo){return 0}var tmpArray=nodeNo.split(CODE_SPLIT);return tmpArray.length-1};this.setOpen=function(isOpen){this.isOpenState=isOpen};this.isOpen=function(){return this.isOpenState};this.addChild=function(child){this.childList.add(child)};this.removeChild=function(childNo){for(var i=0;i<this.childList.size();i++){if(this.childList.get(i).getNodeNo()==childNo){this.childList.remove(i);break}}};this.getChildCnt=function(){return this.childList.size()};this.isRoot=function(){if(this.getLevelCnt()==0){return true}return false};this.hasChild=function(){return this.getChildCnt()>0};this.isLeaf=function(){return(!this.hasChild())};this.setFolder=function(isFolder){this.isFolderState=isFolder};this.isFolder=function(){return this.isFolderState};this.setStyleClass=function(styleClass){this.styleClass=styleClass};this.getStyleClass=function(){return this.styleClass?this.styleClass:""}}function TreeArray(){this.noList=new Array();this.nodeList=new Array();this.getNodeCnt=function(){return this.nodeList.size()};this.indexOfNode=function(nodeNo){var index=this.noList.indexOf(nodeNo);return index};this.indexOfGreat=function(nodeNo){return this.noList.indexOfGreat(nodeNo)};this.indexOfLastDesndnt=function(nodeNo){var rtIndex=-1;var nodeIndex=this.indexOfNode(nodeNo);var nodeCnt=this.getNodeCnt();for(var i=nodeIndex+1;i<nodeCnt;i++){var currNode=this.getNode(i);if(currNode.isDesndntNode(nodeNo)){rtIndex=i}else{break}}return rtIndex};this.addNodeAscOrder=function(node){var nodeNo=node.getNodeNo();if(nodeNo==null){return}if(this.getNodeByNo(nodeNo)){alert("jsp.js.datastructs.js_1");return}var parentNo=node.getParentNo();var parentNode=null;if(parentNo){var parentNode=this.getNodeByNo(parentNo);if(parentNode){parentNode.setFolder(true)}else{alert(lm("jsp.js.datastructs.js_2"));return}}var indexOfGreat=this.indexOfGreat(nodeNo);if(indexOfGreat<0){this.addNode(node)}else{this.addNode(node,indexOfGreat)}if(parentNode){parentNode.addChild(node);node.parentNode=parentNode}};this.addNode=function(node,index){this.noList.add(node.getNodeNo(),index);this.nodeList.add(node,index);if(index>=0){node.index=index}else{node.index=this.nodeList.size()-1}for(var i=index+1;i<this.nodeList.size();i++){var currNode=this.getNode(i);currNode.index=i}};this.getNode=function(index){return this.nodeList.get(index)};this.getNodeByNo=function(nodeNo){return this.getNode(this.indexOfNode(nodeNo))};this.removeANode=function(index){this.noList.remove(index);this.nodeList.remove(index);for(var i=index;i<this.nodeList.size();i++){var currNode=this.getNode(i);currNode.index=i}};this.removeByIndex=function(index){var nodeNo=this.getNode(index).getNodeNo();this.removeCascade(nodeNo)};this.removeCascade=function(nodeNo){if(!nodeNo){return}if(this.noList.indexOf(nodeNo)<0){return}var node=this.getNodeByNo(nodeNo);var nodeCnt=this.getNodeCnt();for(var i=nodeCnt-1;i>=0;i--){var node=this.getNode(i);var currNo=node.getNodeNo();if(currNo==nodeNo||node.isDesndntNode(nodeNo)){this.removeANode(i)}}var parentNo=node.getParentNo();if(parentNo){var parentNode=this.getNodeByNo(parentNo);parentNode.parentNode.removeChild(nodeNo)}};this.setOpen=function(nodeNo,isOpen){var node=this.getNodeByNo(nodeNo);node.setOpen(isOpen)};this.setSelectedCascade=function(nodeNo,isChecked){var node=this.getNodeByNo(nodeNo);node.isSelected=isChecked;this.refreshUp(node);this.refreshDown(node)};this.refreshUp=function(node){if(node.isRoot()){return}var parentNode=node.parentNode;var hasChildChecked=false;for(var i=0;i<parentNode.childList.size();i++){var currNode=parentNode.childList.get(i);if(currNode.isSelected){hasChildChecked=true;break}}parentNode.isSelected=hasChildChecked;if(!parentNode.isRoot()){this.refreshUp(parentNode)}};this.refreshDown=function(node){if(node.isLeaf()){return}for(var i=0;i<node.childList.size();i++){var currNode=node.childList.get(i);currNode.isSelected=node.isSelected;if(currNode.isLeaf()){continue}else{this.refreshDown(currNode)}}};this.getFirstSelectedNode=function(){for(var i=0;i<this.nodeList.size();i++){var currNode=this.nodeList.get(i);if(currNode.isSelected){return currNode}}return null}};