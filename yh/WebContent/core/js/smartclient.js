var rsText=null;function processKiloSplit(queryParams){queryParams=queryParams.replace(/(?:%2C|,)(\d{3})/g,"$1");return queryParams}function mergeQueryString(){var args=$A(arguments);var argCnt=args.length;var params="";for(var i=0;i<argCnt;i++){var argObj=args[i];if(typeof argObj=="string"){if(argObj.length<1){continue}var pattern=/^(.+=.*)+(&.+=.*)*$/gi;if(pattern.test(argObj)){params+="&"+argObj}else{params+="&"+$(argObj).serialize()}}else{if(argObj.tagName&&argObj.tagName.toLowerCase()=="form"){params+="&"+$(argObj).serialize()}else{params+="&"+$H(argObj).toQueryString()}}}return params.substring(1)}function getTextRs(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:false};return getRsBasic(queryOption,isClearKiloSplit,"text")}function getBooleanRs(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:false};return getRsBasic(queryOption,isClearKiloSplit,"boolean")}function getIntRs(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:false};return getRsBasic(queryOption,isClearKiloSplit,"int")}function getFloatRs(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:false};return getRsBasic(queryOption,isClearKiloSplit,"float")}function getJsonRs(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:false};return getRsBasic(queryOption,isClearKiloSplit,"json")}function getXmlRs(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:false};return getRsBasic(queryOption,isClearKiloSplit,"xml")}function getTextRsAsyn(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:true};getRsBasic(queryOption,isClearKiloSplit,"text")}function getBooleanRsAsyn(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:true};getRsBasic(queryOption,isClearKiloSplit,"boolean")}function getIntRsAsyn(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:true};getRsBasic(queryOption,isClearKiloSplit,"int")}function getFloatRsAsyn(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:true};getRsBasic(queryOption,isClearKiloSplit,"float")}function getJsonRsAsyn(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:true};getRsBasic(queryOption,isClearKiloSplit,"json")}function getXmlRsAsyn(actionUrl,queryParams,callBackFunc,isClearKiloSplit){var queryOption={queryParams:queryParams,actionUrl:actionUrl,callBackFunc:callBackFunc,isAsyn:true};getRsBasic(queryOption,isClearKiloSplit,"xml")}function getRsBasic(queryOption,isClearKiloSplit,rsType){this.retData=null;this.defaultHandler=function(data){if(queryOption.isAsyn){return}this.retData=data};var queryParams=queryOption.queryParams;var actionUrl=queryOption.actionUrl;var callBackFunc=queryOption.callBackFunc?queryOption.callBackFunc:bindFunc(this.defaultHandler,this);var isAsyn=queryOption.isAsyn?true:false;if(isClearKiloSplit){queryParams=processKiloSplit(queryParams)}new Ajax.Request(actionUrl,{parameters:queryParams,asynchronous:isAsyn,onSuccess:function(transport,json){rsText=transport.responseText;if(!rsType||rsType.toLowerCase()=="text"){callBackFunc(transport.responseText)}else{if(rsType.toLowerCase()=="boolean"){var rtBool=true;var rtText=trim(transport.responseText);if(!rtText||rtText.toLowerCase()=="false"){rtBool=false}callBackFunc(rtBool)}else{if(rsType.toLowerCase()=="int"){callBackFunc(parseInt(trim(transport.responseText)))}else{if(rsType.toLowerCase()=="float"){callBackFunc(parseFloat(trim(transport.responseText)))}else{if(rsType.toLowerCase()=="json"){try{if(jsonDebug){showLog("JsonText"+transport.responseText)}}catch(e){}if(json){callBackFunc(json)}else{var rtJson=transport.responseText.evalJSON();callBackFunc(rtJson)}}else{if(rsType.toLowerCase()=="xml"){callBackFunc(transport.responseXML)}else{callBackFunc(transport.responseText)}}}}}}},onFailure:function(transport,json){try{if(jsonDebug){showLog("JsonText"+transport.responseText)}}catch(e){}rtText=transport.responseText},onException:function(request,exception){}});if(this.retData){return this.retData}}var Assertor={needFormatAmt:function(cntrl,msrg,extFunc){if(typeof cntrl=="string"){var nameArray=cntrl.split(",");for(var i=0;i<nameArray.length;i++){this.needAssertNum(nameArray[i],amtScale,true,msrg,extFunc)}}else{this.needAssertNum(cntrl,amtScale,true,msrg,extFunc)}},needFormatExchRate:function(cntrl,msrg,extFunc){if(typeof cntrl=="string"){var nameArray=cntrl.split(",");for(var i=0;i<nameArray.length;i++){this.needAssertNum(nameArray[i],exchScale,true,msrg,extFunc)}}else{this.needAssertNum(cntrl,exchScale,true,msrg,extFunc)}},needFormatNum:function(cntrl,scale,msrg,extFunc){this.needAssertNum(cntrl,scale,true,msrg,extFunc)},needFormatInt:function(cntrl,msrg,extFunc){this.needAssertNum(cntrl,0,false,msrg,extFunc)},needAssertNum:function(cntrl,scale,isKiloSplit,msrg,extFunc){cntrl=$(cntrl);cntrl.onblur=function(){var valueStr=clearKiloSplit(cntrl.value);if(!assertNumber(valueStr,cntrl,msrg)){return}if(isKiloSplit){cntrl.value=insertKiloSplit(valueStr,scale)}if(extFunc){extFunc(cntrl)}}},needAssertDate:function(cntrl,msrg,extFunc){if(typeof cntrl=="string"){var nameArray=cntrl.split(",");for(var i=0;i<nameArray.length;i++){this.registAssertor(assertDate,nameArray[i],msrg,extFunc)}}else{this.registAssertor(assertDate,cntrl,msrg,extFunc)}},assertFilled:function(cntrl,msrg){if(typeof cntrl=="string"){var nameArray=cntrl.split(",");for(var i=0;i<nameArray.length;i++){var currCntrl=$(nameArray[i]);if(!assertFilled(currCntrl.value,currCntrl,msrg)){return false}}return true}else{var currCntrl=$(cntrl);return assertFilled(currCntrl.value,currCntrl,msrg)}},registAssertor:function(assertFunc,cntrl,msrg,extFunc){cntrl=$(cntrl);cntrl.onblur=function(){var valueStr=cntrl.value;if(!assertFunc(valueStr,cntrl,msrg)){return}if(extFunc){extFunc(cntrl)}}}};var StateManager={stateStyle:{defaultStyle:"input",input_active_number:"InputTextNum ",input_readOnly_number:"InputTextNumReadOnly",input_disabled_number:"InputTextNumReadOnly",input_active_text:"InputTextTextActive",input_readOnly_text:"InputTextTextReadOnly",input_disabled_text:"InputTextTextReadOnly",select_active:"input_select",select_readOnly:"input_select",select_disabled:"input_select",img_active:"btn_img",img_readOnly:"btn_img",img_disabled:"btn_img"},getDispStyle:function(cntrl,state,cntrlType){cntrl=$(cntrl);if(!state){state="writable"}var tagName=cntrl.tagName.toLowerCase();if(["input","textarea"].include(tagName)){tagName="input";if(!cntrlType){cntrlType="text"}}else{if("img"==tagName){tagName="img";cntrlType=""}else{tagName="select";cntrlType=""}}var selectName=tagName+"_"+state;if(cntrlType){selectName=selectName+"_"+cntrlType}return this.stateStyle[selectName]},_setState:function(cntrl,cntrlState,styleClass,value,otherAttrs){if(cntrlState){cntrl.readOnly=cntrlState.readOnly;cntrl.disabled=cntrlState.disabled}if(styleClass){cntrl.className=styleClass}if(value){cntrl.value=value}if(otherAttrs){var attrArray=otherAttrs.split(",");for(var i=0;i<attrArray.length;i++){var paramArray=attrArray[i].split("=");cntrl[paramArray[0]]=paramArray[1]}}},setState:function(state,cntrlState,cntrls,cntrlType,values,otherAttrs){if(typeof cntrls=="string"&&cntrls.indexOf(",")>0){var cntrlArray=cntrls.split(",");var valueArray=null;if(values){valueArray=values.split(",")}for(var i=0;i<cntrlArray.length;i++){var cntrl=cntrlArray[i];var value=null;if(valueArray){value=valueArray[i]}this.setState(state,cntrlState,cntrl,cntrlType,value)}}else{var cntrl=$(cntrls);if(!cntrl||cntrl.style.display=="none"){return}if(cntrl.type=="hidden"){var cntrlName=cntrl.name?cntrl.name:cntrl.id;var inputName=cntrlName+"_DISP";var btnName="btn"+cntrlName;var inputCntrl=$(inputName);var butnCntrl=$(btnName);if(inputCntrl&&butnCntrl){this._setState(inputCntrl,cntrlState,this.getDispStyle(inputCntrl,state,cntrlType),values,otherAttrs);if(cntrlState.readOnly){cntrlState.disabled=true}this._setState(butnCntrl,cntrlState,this.getDispStyle(butnCntrl,state,cntrlType),null,otherAttrs)}}else{this._setState(cntrl,cntrlState,this.getDispStyle(cntrls,state,cntrlType),values,otherAttrs)}}},setActive:function(cntrls,cntrlType,values,otherAttrs){this.setState("active",{readOnly:false,disabled:false},cntrls,cntrlType,values,otherAttrs)},setReadOnly:function(cntrls,cntrlType,values,otherAttrs){this.setState("readOnly",{readOnly:true,disabled:false},cntrls,cntrlType,values,otherAttrs)},setDisabled:function(cntrls,cntrlType,values,otherAttrs){this.setState("disabled",{readOnly:true,disabled:true},cntrls,cntrlType,values,otherAttrs)}};var ClientCatch=new function(){var _catch=new ArrayHashMap();this.getObj=function(key,queryParam,actionUrl){var rtObj=_catch.get(key);if(rtObj){return rtObj}if(!actionUrl){actionUrl=_urlMap[key]}if(!actionUrl){actionUrl=key}actionUrl=contextPath+actionUrl;getJsonRs(queryParam,actionUrl,function(data){if(data){_catch.put(key,data.getData())}});return _catch.get(key)};this.reloadObj=function(key,queryParam,actionUrl){var rtObj=_catch.get(key);if(rtObj){_catch.remove(key)}return this.getObj(key,queryParam,actionUrl)}};